<h1 id="mapmodule">mapmodule</h1>
<h2 id="description">Description</h2>
<p>Provides abstraction for map implementation (Openlayers 2/3) and provides a plugin mechanism to add additional functionality to map.</p>
<h2 id="todo">TODO</h2>
<ul>
<li>Configurable zoomlevels</li>
</ul>
<h2 id="bundle-configuration">Bundle configuration</h2>
<p>Some configuration is needed for URLs:</p>
<pre><code class="language-javascript">{
  &quot;termsUrl&quot; : {
    &quot;fi&quot; : &quot;//www.paikkatietoikkuna.fi/web/fi/kayttoehdot&quot;,
    &quot;sv&quot; : &quot;//www.paikkatietoikkuna.fi/web/sv/anvandningsvillkor&quot;,
    &quot;en&quot; : &quot;//www.paikkatietoikkuna.fi/web/en/terms-and-conditions&quot;
  },
  &quot;mapUrlPrefix&quot; : {
    &quot;fi&quot;:&quot;//www.paikkatietoikkuna.fi/web/fi/kartta?&quot;,
    &quot;sv&quot;:&quot;//www.paikkatietoikkuna.fi/web/sv/kartfonstret?&quot;,
    &quot;en&quot;:&quot;//www.paikkatietoikkuna.fi/web/en/map-window?&quot;
  }
}
</code></pre>
<p>Configuration is not handled like normal bundles.</p>
<p>Configuration can be given when constructing the mapmodule through constructor call. Usually its passed through the mapfull bundle configuration:</p>
<pre><code class="language-javascript">{
    &quot;resolutions&quot; : [8192, 4096, 2048, 1024, 512, 256, 128, 64, 32, 16, 8, 4, 2, 1, 0.5, 0.25],
    &quot;maxExtent&quot; : {
        &quot;left&quot; : -548576.0,
        &quot;bottom&quot; : 6291456.0,
        &quot;right&quot; : 1548576.0,
        &quot;top&quot; :  8388608
    },
    &quot;units&quot; : &quot;m&quot;,
    &quot;srsName&quot; : &quot;EPSG:3067&quot;,
    &quot;openLayers&quot; : {
        &quot;imageReloadAttemps&quot;: 5,
        &quot;onImageLoadErrorColor&quot;: &quot;transparent&quot;
    }
}
</code></pre>
<h2 id="bundle-state">Bundle state</h2>
<p>No statehandling has been implemented.</p>
<h2 id="bundle-functions">Bundle functions</h2>
<h3 id="getprojectiondecimals">getProjectionDecimals</h3>
<p>Function returns wanted projection decimals. If wanted projection is not defined, then using map projection. Decimals concluded from projection units. Now &#39;degrees&#39; units returns 6 and &#39;m&#39; units returns 0.
For example:</p>
<pre><code class="language-javascript">var mapModule = Oskari.getSandbox().findRegisteredModuleInstance(&#39;MainMapModule&#39;);
var mapProjectionDecimals = mapmodule.getProjectionDecimals();
console.log(&#39;Map projection decimals = &#39;+mapProjectionDecimals);
var WGS84Decimals = mapmodule.getProjectionDecimals(&#39;EPSG:4326&#39;);
console.log(&#39;WGS84 projection decimals = &#39;+WGS84Decimals);
</code></pre>
<h3 id="getprojectionunits">getProjectionUnits</h3>
<p>Function returns wanted projection units. If wanted projection is not defined, then using map projection.
For example:</p>
<pre><code class="language-javascript">var mapModule = Oskari.getSandbox().findRegisteredModuleInstance(&#39;MainMapModule&#39;);
var mapUnits = mapModule.getProjectionUnits();
console.log(&#39;Map projection units = &#39; + mapUnits);
var WGS84Units = mapModule.getProjectionUnits(&#39;EPSG:4326&#39;);
console.log(&#39;WGS84 projection units = &#39; + WGS84Units);
</code></pre>
<h2 id="requests-the-bundle-handles">Requests the bundle handles</h2>
<table class="table">
  <tr>
    <th> Request </th><th> Where/why it's used</th>
  </tr>
  <tr>
    <td> MapModulePlugin.MapLayerUpdateRequest </td><td> Forces openlayers update the layers of tiles</td>
  </tr>
  <tr>
    <td> MapMoveRequest </td><td> Moving map position</td>
  </tr>
  <tr>
    <td> ClearHistoryRequest </td><td> Clearing Openlayers history(not used yet, the history handling are yet in statehandler)</td>
  </tr>
</table>

<ul>
<li>Plugins might handle additional requests</li>
</ul>
<h2 id="requests-the-bundle-sends-out">Requests the bundle sends out</h2>
<p>This bundle doesn&#39;t send out any requests</p>
<ul>
<li>Plugins might send additional requests</li>
</ul>
<h2 id="events-the-bundle-listens-to">Events the bundle listens to</h2>
<table class="table">
  <tr>
    <th> Event </th><th> How does the bundle react</th>
  </tr>
  <tr>
    <td> SearchClearedEvent</td><td> Removing all markers from map</td>
  </tr>
</table>

<ul>
<li>Plugins might listen to additional events</li>
</ul>
<h2 id="events-the-bundle-sends-out">Events the bundle sends out</h2>
<table class="table">
  <tr>
    <th> Event </th><th>Why/when</th>
  </tr>
  <tr>
    <td> MapMoveStartEvent </td><td> When draging start</td>
  </tr>
  <tr>
    <td> AfterMapMoveEvent</td><td> After map has moved</td>
  </tr>
</table>

<ul>
<li>Plugins might send additional events</li>
</ul>
<h2 id="dependencies">Dependencies</h2>
<table class="table">
  <tr>
    <th> Dependency </th><th> Linked from </th><th> Purpose </th>
  </tr>
  <tr>
    <td> [OpenLayers](http://openlayers.org/) </td>
    <td> Expects OpenLayers already linked </td>
    <td> Used for all map functionality</td>
  </tr>
</table>


<h2 id="requests-that-the-bundle-handles">Requests that the bundle handles</h2>
<table class="table"><tr><th> Request </th><th> Use </th></tr>
<tr><td><a href="requests#latest/mapping/mapmodule/request/addfeaturestomaprequest.md">AddFeaturesToMapRequest </a></td><td>Allows user to add features to map.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/addmaplayerrequest.md">AddMapLayerRequest</a></td><td>Adds a layer to the map.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/addmarkerrequest.md">AddMarkerRequest </a></td><td>Add marker to certain point on map.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/changemaplayeropacityrequest.md">ChangeMapLayerOpacityRequest </a></td><td>Allows user to change map layer opacity on a map.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/changemaplayerstylerequest.md">ChangeMapLayerStyleRequest </a></td><td>Allow user to change map layer style between preconfigured options on the map (styles available for a WMS-layer etc).</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/disablemapkeyboardmovementrequest.md">DisableMapKeyboardMovementRequest</a></td><td>Disable map keyboard movement.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/disablemapmousemovementrequest.md">DisableMapMouseMovementRequest</a></td><td>Disable map mouse movement.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/enablemapkeyboardmovementrequest.md">EnableMapKeyboardMovementRequest</a></td><td>Enable map keyboard movement.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/enablemapmousemovementrequest.md">EnableMapMouseMovementRequest</a></td><td>Enable map mouse movement.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/GetFeatureInfoRequest.md">GetFeatureInfoRequest </a></td><td>Display feature info box.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/getuserlocationrequest.md">GetUserLocationRequest </a></td><td>Get user's location</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/map.layer.activation.md">map.layer.activation</a></td><td>Flags the layer as activated/deactivated.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/MapModulePlugin.MapLayerUpdateRequest.md">MapModulePlugin.MapLayerUpdateRequest</a></td><td>Update the map layer data on map.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/MapModulePlugin.MapLayerVisibilityRequest.md">MapModulePlugin.MapLayerVisibilityRequest </a></td><td>Allows user to change map layer visibility.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/MapModulePlugin.MapMoveByLayerContentRequest.md">MapModulePlugin.MapMoveByLayerContentRequest</a></td><td>Allows the user to move the map by the layer content.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/MapModulePlugin.RegisterStyleRequest.md">MapModulePlugin.RegisterStyleRequest</a></td><td>Allows user to add wellknown svg styles.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/MapMoveRequest.md">MapMoveRequest </a></td><td>Allows user to move the map to certain location.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/MapTourRequest.md">MapTourRequest </a></td><td>Allows programmatic tour around the map showcasing multiple locations</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/markervisibilityrequest.md">MapModulePlugin.MarkerVisibilityRequest </a></td><td>Show or hide marker from map.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/rearrangeselectedmaplayerrequest.md">RearrangeSelectedMapLayerRequest </a></td><td>Allow user to change order of map layers in relation to other layers on the map.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/removefeaturesfrommaprequest.md">RemoveFeaturesFromMapRequest </a></td><td>Remove vector features from map</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/RemoveMapLayerRequest.md">RemoveMapLayerRequest</a></td><td>Removes a map layer from map.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/removemarkersrequest.md">RemoveMarkersRequest </a></td><td>Remove markers from the map.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/SetTimeRequest.md">SetTimeRequest </a></td><td>Allows programmatic change of time for 3d map</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/ShowProgressSpinnerRequest.md">ShowProgressSpinnerRequest </a></td><td>Allows progress spinner to be shown or hidden on a map.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/StartUserLocationTrackingRequest.md">StartUserLocationTrackingRequest </a></td><td>Start tracking user's location.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/StopUserLocationTrackingRequest.md">StopUserLocationTrackingRequest </a></td><td>Stop tracking user's location.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/vectorlayerrequest.md">VectorLayerRequest </a></td><td>Adds a new feature layer to map or updates an existing layer.</td></tr><tr><td><a href="requests#latest/mapping/mapmodule/request/zoomtofeaturesrequest.md">ZoomToFeaturesRequest </a></td><td>Moves map to show referenced vector features on the viewport.</td></tr></table>


<h2 id="events-that-the-bundle-sends">Events that the bundle sends</h2>
<table class="table"><tr><th> Event </th><th> Use </th></tr>
<tr><td><a href="events#latest/mapping/mapmodule/event/AfterAddMarkerEvent.md">AfterAddMarkerEvent </a></td><td>Notifies that marker has been added to the map.</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/AfterMapMoveEvent.md">AfterMapMoveEvent </a></td><td>Notifies that map has been moved or zoomed.</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/AfterRemoveMarkersEvent.md">AfterRemoveMarkersEvent</a></td><td>Event is sent after map markers are removed</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/DataForMapLocationEvent.md">DataForMapLocationEvent </a></td><td>Notifies application that a click on the map resulted in more data for that location (GFI style content).</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/EscPressedEvent.md">EscPressedEvent</a></td><td>Event is sent when ESC key in keyboard is pressed so bundles can react to it.</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/featureevent.md">FeatureEvent </a></td><td>Used to notify about add, remove, update and click events for features.</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/GetInfoResultEvent.md">GetInfoResultEvent</a></td><td>Update map click information coming from ajax request</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/LayerToolsEditModeEvent.md">LayerToolsEditModeEvent</a></td><td>Event sent when user edits layout order</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/map.layer.activation.md">map.layer.activation</a></td><td>Triggered when a layer has activated/deactivated.</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/MapClickedEvent.md">MapClickedEvent </a></td><td>Notifies user that map has been clicked.</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/MapLayerVisibilityChangedEvent.md">MapLayerVisibilityChangedEvent</a></td><td>This is used to notify that layers visibility has changed. Either the map has
moved out of the layers scale range or the layers geometry is no longer in the maps viewport.
Listeners should also check getMapLayer().getVisible() method that indicates if the map has been hidden by the user.</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/MapSizeChangedEvent.md">MapSizeChangedEvent</a></td><td>Event is sent when the map div size is changed</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/MapTourEvent.md">MapTourEvent </a></td><td>Notifies status of MapTourRequest</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/MarkerClickEvent.md">MarkerClickEvent </a></td><td>Notifies that map marker has been clicked.</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/MouseHoverEvent.md">MouseHoverEvent</a></td><td>Notifies user about the pointer moves.</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/ProgressEvent.md">ProgressEvent</a></td><td>An event that tells if something is progressing or is it done (layers loading / layers done loading)</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/TimeChangedEvent.md">TimeChangedEvent </a></td><td>Notifies of changed time</td></tr><tr><td><a href="events#latest/mapping/mapmodule/event/userlocationevent.md">UserLocationEvent </a></td><td>Notifies user location.</td></tr></table>


<hr style="height:50px;">


<h1 id="background-layer-selection-plugin">Background Layer Selection Plugin</h1>
<h2 id="description-1">Description</h2>
<p>This plugin provides a background maplayer selection &quot;dropdown&quot; on top of the map.</p>
<h2 id="screenshot">Screenshot</h2>
<h2 id="closed">Closed</h2>
<p><img src="/apires/latest/mapping/mapmodule/images/backgroundlayerselection_closed.png" alt="closed"></p>
<h2 id="open">Open</h2>
<p><img src="/apires/latest/mapping/mapmodule/images/backgroundlayerselection_open.png" alt="open"></p>
<h2 id="list">List</h2>
<p><img src="/apires/latest/mapping/mapmodule/images/backgroundlayerselection_list.png" alt="list"></p>
<h2 id="bundle-configuration-1">Bundle configuration</h2>
<pre><code class="language-javascript">{
  &quot;baseLayers&quot; : [&quot;&lt;layerid 1&gt;&quot;,&quot;&lt;layerid 2&gt;&quot;,&quot;&lt;layerid 3&gt;&quot;&quot;],
  &quot;showAsDropdown&quot; : &lt;true/false&gt;
}
</code></pre>
<p>Configuration is required to define the preset background layers.</p>
<p>UI can be presented as a button bar or a dropdown, this is controlled with <code>showAsDropdown</code>, which defaults to false.</p>
<p>The font and colour scheme of the plugin are configurable, with variables <code>font</code> (String) and <code>colorScheme</code> (Object) respectively. A CSS class of <code>oskari-publisher-font-&lt;font&gt;</code> is expected to be defined with font-family definition. The <code>colorScheme</code> object should have keys <code>buttonColor</code>, <code>buttonBackgroundColor</code>, <code>buttonSelectedColor</code>, <code>buttonSelectedBackgroundColor</code> and <code>buttonBorderColor</code>.</p>
<h2 id="requests-the-plugin-handles">Requests the plugin handles</h2>
<p>This plugin doesn&#39;t handle any requests.</p>
<h2 id="requests-the-plugin-sends-out">Requests the plugin sends out</h2>
<table class="table">
  <tr>
    <th>Request</th><th>Why/when</th>
  </tr>
  <tr>
    <td>MapModulePlugin.RemoveMapLayerRequest</td>
    <td>Remove old background layer selection</td>
  </tr>
  <tr>
    <td>MapModulePlugin.AddMapLayerRequest</td>
    <td>Add new background layer selection</td>
  </tr>
  <tr>
    <td>MapModulePlugin.RearrangeSelectedMapLayerRequest</td>
    <td>Move bg layer to bottom</td>
  </tr>
</table>

<h2 id="events-the-plugin-listens-to">Events the plugin listens to</h2>
<table class="table">
  <tr>
    <th>Event</th><th>Why/when</th>
  </tr>
  <tr>
    <td>Oskari.mapframework.event.common.AfterRearrangeSelectedMapLayerEvent</td>
    <td>Update selection, bottom baselayer might've changed</td>
  </tr>
  <tr>
    <td>Oskari.mapframework.event.common.AfterMapLayerRemoveEvent</td>
    <td>Redo ui, one of the preset bg layers might've been deleted</td>
  </tr>
  <tr>
    <td>Oskari.mapframework.event.common.AfterMapLayerAddEvent</td>
    <td>Redo ui, we might've gotten a previously missing preset bg layer</td>
  </tr>
  <tr>
    <td>Oskari.mapframework.event.common.MapLayerEvent</td>
    <td>Redo ui, we might've gotten a previously missing preset bg layer</td>
  </tr>
</table>

<h2 id="events-the-plugin-sends-out">Events the plugin sends out</h2>
<p>This bundle doesn&#39;t send any events.</p>
<h2 id="dependencies-1">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [jQuery](http://api.jquery.com/) </td>
    <td> Version 1.7.1 assumed to be linked (on page locally in portal) </td>
    <td> Used to create the UI</td>
  </tr>
</table>


<hr style="height:50px;">


<h1 id="controls-plugin">Controls Plugin</h1>
<h2 id="description-2">Description</h2>
<p>ControlsPlugin adds zoombox, measure, keyboard and mouse controls to the map.</p>
<h2 id="bundle-configuration-2">Bundle configuration</h2>
<p>Map controls are configurable - setting the control values as false the control is not added. All controls are added by default if not explicitly configured.</p>
<pre><code class="language-javascript">{
  &quot;conf&quot;: {
    &quot;zoomBox&quot; : false,
    &quot;measureControls&quot; : false,
    &quot;keyboardControls&quot; : false,
    &quot;mouseControls&quot; : false
  }
}
</code></pre>
<h2 id="bundle-state-1">Bundle state</h2>
<p>No statehandling has been implemented.</p>
<h2 id="requests-the-bundle-handles-1">Requests the bundle handles</h2>
<table class="table">
  <tr>
    <th>Request</th><th>How does the bundle react</th>
  </tr>
  <tr>
    <td>ToolSelectionRequest</td><td>Activates requested control</td>
  </tr>
  <tr>
    <td>EnableMapKeyboardMovementRequest</td><td>Enables keyboard movement (if it isn't configured otherwise)</td>
  </tr>
  <tr>
    <td>DisableMapKeyboardMovementRequest</td><td>Disables keyboard movement</td>
  </tr>
  <tr>
    <td>EnableMapMouseMovementRequest</td><td>Enables mouse movement (if it isn't configured otherwise)</td>
  </tr>
  <tr>
    <td>DisableMapMouseMovementRequest</td><td>Disables mouse movement</td>
  </tr>
</table>


<h2 id="requests-the-bundle-sends-out-1">Requests the bundle sends out</h2>
<p>This bundle doesn&#39;t send out any requests.</p>
<h2 id="events-the-bundle-listens-to-1">Events the bundle listens to</h2>
<table class="table">
  <tr>
    <th>Event</th><th>How does the bundle react</th>
  </tr>
  <tr>
    <td>Toolbar.ToolSelectedEvent</td><td>Disables zoom/measure controls</td>
  </tr>
</table>


<h2 id="events-the-bundle-sends-out-1">Events the bundle sends out</h2>
<p>This bundle doesn&#39;t send out any events.</p>
<h2 id="dependencies-2">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [Oskari mapmodule](/documentation/bundles/framework/mapmodule) </td>
    <td> Expects to be present in application setup </td>
    <td> Controls will be added to map module </td>
  </tr>
</table>



<hr style="height:50px;">


<h1 id="data-source-plugin">Data Source Plugin</h1>
<table class="table">
  <tr>
    <td>API</td><td>[link here](/api/latest/classes/Oskari.mapframework.bundle.mapmodule.plugin.DataSourcePlugin.html)</td>
  </tr>
</table>

<h2 id="description-3">Description</h2>
<p>Renders a pop-up that contains a list of data providers based on selected layers.</p>
<h2 id="screenshot-1">Screenshot</h2>
<p><img src="/apires/latest/mapping/mapmodule/images/datasource.png" alt="screenshot"></p>
<h2 id="bundle-configuration-3">Bundle configuration</h2>
<p>No configuration is required.</p>
<h2 id="bundle-state-2">Bundle state</h2>
<p>No statehandling has been implemented.</p>
<h2 id="requests-the-bundle-handles-2">Requests the bundle handles</h2>
<p>This bundle doesn&#39;t handle any requests.</p>
<h2 id="requests-the-bundle-sends-out-2">Requests the bundle sends out</h2>
<p>This bundle doesn&#39;t send out any requests.</p>
<h2 id="events-the-bundle-listens-to-2">Events the bundle listens to</h2>
<table class="table">
  <tr>
    <th>Event</th><th>How does the bundle react</th>
  </tr>
  <tr>
    <td>openDialog</td><td>Opens up pop-up</td>
  </tr>
  <tr>
    <td>getMetadataInfoCallback</td><td>shows metadata associated with the layer</td>
  </tr>
</table>


<h2 id="events-the-bundle-sends-out-2">Events the bundle sends out</h2>
<p>This bundle doesn&#39;t send out any events.</p>
<h2 id="dependencies-3">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [jQuery](http://api.jquery.com/) </td>
    <td> Version 1.7.1 assumed to be linked on the page</td>
    <td> Used to create the UI and to sort the layers</td>
  </tr>
  <tr>
    <td>[OpenLayers](http://openlayers.org/)</td>
    <td>not linked, assumes its linked by map</td>
    <td>Uses OpenLayers' popup</td>
  </tr>
</table>



<hr style="height:50px;">


<h1 id="geo-location-plugin">Geo Location Plugin</h1>
<h2 id="description-4">Description</h2>
<p>The plugin tries to locate the user with HTML5 GeoLocation or if that is not available, checks if the javascript methods provided by <a href="http://dev.maxmind.com/geoip/javascript">http://dev.maxmind.com/geoip/javascript</a> are present and uses them if available. If location is successfully determined, centers the map on the location and zoom level 6. The HTML5 geolocation is parametrized to allow for max. one hour cached result and a timeout of 6 seconds.</p>
<h2 id="bundle-configuration-4">Bundle configuration</h2>
<p>No configuration is required.</p>
<h2 id="requests-the-plugin-handles-1">Requests the plugin handles</h2>
<p>This plugin doesn&#39;t handle any requests.</p>
<h2 id="requests-the-plugin-sends-out-1">Requests the plugin sends out</h2>
<p>This plugin doesn&#39;t sends any requests.</p>
<h2 id="events-the-plugin-listens-to-1">Events the plugin listens to</h2>
<p>This plugin doesn&#39;t listen to any events.</p>
<h2 id="events-the-plugin-sends-out-1">Events the plugin sends out</h2>
<p>This bundle doesn&#39;t send any events.</p>
<h2 id="dependencies-4">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td>[OpenLayers](http://openlayers.org/)</td>
    <td>not linked, assumes its linked by map</td>
    <td>Uses mapmodule to transform geolocation coordinates from "EPSG:4326" to maps current projection</td>
  </tr>
</table>


<hr style="height:50px;">


<h1 id="get-info-plugin">Get Info Plugin</h1>
<h2 id="description-5">Description</h2>
<p>This plugin provides view of the from GetFeatureInfo and similar results what are processed in backend</p>
<h2 id="screenshot-2">Screenshot</h2>
<p><img src="/apires/latest/mapping/mapmodule/images/gfi_query.png" alt="screenshot"></p>
<h2 id="bundle-configuration-5">Bundle configuration</h2>
<p>Handling infoBox and ignoredLayerTypes in the plugin are made configurable. infoBox variable makes it possible to request infoBox with additional information later on. ignoredLayerTypes is an array of layer types that are ignored in the requests. This functionality is made because of new mapwfs2 which controls WFS&#39;s GFI data.</p>
<p>The colour scheme and font of the plugin are configurable, with variables <code>colourScheme</code> (Object) and <code>font</code> (String), respectively. A CSS class of <code>oskari-publisher-font-&lt;font&gt;</code> is expected to be defined with font-family definition. The structure of <code>colourScheme</code> should be of following format:</p>
<pre><code class="language-javascript">{
  &quot;val&quot;: &quot;&lt;id of the colour scheme, eg. &#39;blue&#39;&gt;&quot;,
  &quot;bgColour&quot;: &quot;&lt;the colour of the gfi popup header background, eg. &#39;#0091FF&#39;&gt;&quot;,
  &quot;titleColour&quot;: &quot;&lt;the colour of the gfi popup header text, eg. &#39;#FFFFFF&#39;&gt;&quot;,
  &quot;headerColour&quot;: &quot;&lt;the colour of myplaces popup title text, eg. &#39;#0091FF&#39;&gt;&quot;,
  &quot;iconCls&quot;: &quot;&lt;either &#39;icon-close&#39; or &#39;icon-close-white&#39;&gt;&quot;
}
</code></pre>
<h2 id="requests-the-plugin-handles-2">Requests the plugin handles</h2>
<p>This plugin doesn&#39;t handle any requests.</p>
<h2 id="requests-the-plugin-sends-out-2">Requests the plugin sends out</h2>
<p>This plugin doesn&#39;t sends out any requests</p>
<h2 id="events-the-bundle-listens-to-3">Events the bundle listens to</h2>
<table class="table">
  <tr>
    <th> Event </th><th> How does the bundle react</th>
  </tr>
  <tr>
    <td> EscPressedEvent </td><td> Closing GetInfo "popup" from screen.</td>
  </tr>
  <tr>
    <td> MapClickedEvent </td><td> Send ajax request to backend system.</td>
  </tr>
  <tr>
    <td> AfterMapMoveEvent </td><td> Cancel ajax request.</td>
  </tr>
</table>

<h2 id="events-the-plugin-sends-out-2">Events the plugin sends out</h2>
<table class="table">
  <tr>
    <th>Event</th><th>Why/when</th>
  </tr>
  <tr>
    <td>GetInfoResultEvent</td><td> Result of ajax request formatted send as an event so that infobox handling can be done elsewhere </td>
  </tr>
</table>

<h2 id="dependencies-5">Dependencies</h2>
<table class="table">
  <tr>
    <th> Dependency </th><th> Linked from </th><th> Purpose</th>
  </tr>
  <tr>
    <td> [jQuery](http://api.jquery.com/) </td>
    <td> Version 1.7.1 assumed to be linked (on page locally in portal) </td>
    <td> Used to create the UI</td>
  </tr>
  <tr>
    <td> [Oskari infobox](/documentation/bundles/framework/infobox) </td>
    <td> Oskari's InfoBoxBundle </td>
    <td> That handles the infobox as an Openlayers popup with customized UI
  </td>
  </tr>
  <tr>
    <td> [Backend API](/documentation/backend/mapmodule/getinfoplugin) </td>
    <td> N/A </td>
    <td> Get info is handle in backend</td>
  </tr>
</table>


<hr style="height:50px;">


<h1 id="index-map-plugin">Index Map Plugin</h1>
<h2 id="description-6">Description</h2>
<p>This plugin adds an indexmap for the map it is registered to.</p>
<h2 id="screenshot-3">Screenshot</h2>
<p><img src="/apires/latest/mapping/mapmodule/images/indexmap_closed.png" alt="closed"></p>
<p>Closed</p>
<p><img src="/apires/latest/mapping/mapmodule/images/indexmap_open.png" alt="open"></p>
<p>Open</p>
<h2 id="bundle-configuration-6">Bundle configuration</h2>
<p>No configuration is required, in which case the indexmap appears on the lower right corner of the map by default. If there are many elements in the same location, variable &#39;position&#39; defines the order of the elements. </p>
<p>If you wish to change the location of the indexmap, you have two possibilities:</p>
<ol>
<li>Define location on a map by configuring variables &#39;classes&#39; and &#39;position&#39;. Below are the default values.</li>
</ol>
<pre><code class="language-javascript">{
  &quot;location&quot; : {
        &quot;classes&quot; : &quot;bottom right&quot;,
        &quot;position&quot; : 5
  }
};
</code></pre>
<ol start="2">
<li>Define container for the indexmap by configuring containerId.</li>
</ol>
<pre><code class="language-javascript">{
  &quot;containerId&quot; = &quot;mycontainerId&quot;
} 
</code></pre>
<h3 id="button-icon">Button icon</h3>
<p>By default the button that open the indexmap has an icon with the map of the world. If you want to change this icon, you can override the background with the selector:</p>
<pre><code class="language-css">.indexmapToggle div.icon {
    background-image: url(&#39;path/to/icon&#39;) !important;
}
</code></pre>
<h2 id="requests-the-plugin-handles-3">Requests the plugin handles</h2>
<p>This plugin doesn&#39;t handle any requests.</p>
<h2 id="requests-the-plugin-sends-out-3">Requests the plugin sends out</h2>
<p>This plugin doesn&#39;t sends any requests.</p>
<h2 id="events-the-plugin-listens-to-2">Events the plugin listens to</h2>
<table class="table">
  <tr>
    <th> Event </th><th> How does the bundle react</th>
  </tr>
  <tr>
    <td> AfterMapMoveEvent </td><td> Updates ui to current map location</td>
  </tr>
</table>

<h2 id="events-the-plugin-sends-out-3">Events the plugin sends out</h2>
<table class="table">
  <tr>
    <th> Event </th><th> Why/When</th>
  </tr>
  <tr>
    <td> AfterMapMoveEvent </td><td> After map has moved within the indexmap</td>
  </tr>
</table>

<h2 id="dependencies-6">Dependencies</h2>
<table class="table">
  <tr>
    <th> Dependency </th><th> Linked from </th><th> Purpose</th>
  </tr>
  <tr>
    <td> [OpenLayers](http://openlayers.org/) </td>
    <td> not linked, assumes its linked by map </td>
    <td> Uses OpenLayers.Control.OverviewMap to render the index map.</td>
  </tr>
</table>


<hr style="height:50px;">


<h1 id="layer-selection-plugin">Layer Selection Plugin</h1>
<h2 id="description-7">Description</h2>
<p>This plugin provides a maplayer selection &quot;dropdown&quot; on top of the map.</p>
<h2 id="screenshot-4">Screenshot</h2>
<p><img src="/apires/latest/mapping/mapmodule/images/layerselection_open.png" alt="open"></p>
<h2 id="bundle-configuration-7">Bundle configuration</h2>
<pre><code class="language-javascript">{
  baseLayers : [&#39;&lt;layerid 1&gt;&#39;,&#39;&lt;layerid 2&gt;&#39;,&#39;&lt;layerid 3&gt;&#39;],
  defaultBaseLayer : &#39;&lt;layerid 1&gt;&#39;,
  isStyleSelectable: &lt;boolean&gt;
}
</code></pre>
<p>Configuration is not required, but it can be used to set some selected layers as &quot;base layers&quot;. Baselayers differ from normal layers that only one base layer is shown at a time. Setting <code>isStyleSelectable</code> to true will allow the user to change the style of map layers that have more than one style. This flag can be set in the publisher tool for layer selection.</p>
<p>The styling, font and colour scheme of the plugin are configurable, with variables <code>toolStyle</code> (String), <code>font</code> (String) and <code>colourScheme</code> (Object) respectively. A CSS class of <code>oskari-publisher-font-&lt;font&gt;</code> is expected to be defined with font-family definition. Following values are supported for the <code>toolStyle</code>: <code>rounded-light</code>, <code>rounded-dark</code>, <code>sharp-dark</code>, <code>sharp-light</code>, <code>3d-dark</code> and <code>3d-light</code>. An image <code>map-layer-button-&lt;toolStyle&gt;.png</code> is expected to be found in plugin&#39;s image resources directory. The <code>colourScheme</code> object should have keys <code>bgColour</code>, <code>titleColour</code> and <code>iconCls</code>.</p>
<h2 id="requests-the-plugin-handles-4">Requests the plugin handles</h2>
<p>This plugin doesn&#39;t handle any requests.</p>
<h2 id="requests-the-plugin-sends-out-4">Requests the plugin sends out</h2>
<table class="table">
  <tr>
    <th>Request</th><th>Why/when</th>
  </tr>
  <tr>
    <td>MapModulePlugin.MapLayerVisibilityRequest </td><td> Controls map layer selection by hiding map layers and making them visible on the map</td>
  </tr>
</table>

<h2 id="events-the-plugin-listens-to-3">Events the plugin listens to</h2>
<p>This plugin doesn&#39;t listen any events.</p>
<h2 id="events-the-plugin-sends-out-4">Events the plugin sends out</h2>
<p>This bundle doesn&#39;t send any events.</p>
<h2 id="dependencies-7">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [jQuery](http://api.jquery.com/) </td>
    <td> Version 1.7.1 assumed to be linked (on page locally in portal) </td>
    <td> Used to create the UI</td>
  </tr>
</table>


<hr style="height:50px;">


<h1 id="layers-plugin">Layers Plugin</h1>
<h2 id="description-8">Description</h2>
<p>This is a plugin to bring more functionality for the mapmodules map implementation. It provides handling for rearranging layer order and controlling layer visibility. Provides information to other bundles if a layer becomes visible/invisible (out of scale/out of content geometry) and request handlers to move map to location/scale based on layer content. Also optimizes openlayers maplayers visibility setting if it detects that content is not in the viewport.</p>
<h2 id="todo-1">TODO</h2>
<p>Has some handling for the markers layer. IMHO shouldn&#39;t.</p>
<h2 id="bundle-configuration-8">Bundle configuration</h2>
<p>No configuration is required.</p>
<h2 id="bundle-state-3">Bundle state</h2>
<p>No statehandling has been implemented for this.</p>
<h2 id="requests-the-bundle-handles-3">Requests the bundle handles</h2>
<table class="table">
<tr>
  <th> Request </th><th> How does the bundle react</th>
</tr>
<tr>
  <td> MapModulePlugin.MapLayerVisibilityRequest </td><td> Hides a maplayer or changes a hidden layer to visible.</td>
</tr>
<tr>
  <td> MapModulePlugin.MapMoveByLayerContentRequest </td><td> Moves the map to a location and/or scale where the maplayer has content. (Maplayer geometry is visible in viewport/scale is in range for layer).</td>
</tr>
</table>

<h2 id="requests-the-bundle-sends-out-3">Requests the bundle sends out</h2>
<p>This bundle doesn&#39;t send any requests.</p>
<h2 id="events-the-bundle-listens-to-4">Events the bundle listens to</h2>
<table class="table">
  <tr>
    <th> Event </th><th> How does the bundle react</th>
  </tr>
  <tr>
    <td> AfterRearrangeSelectedMapLayerEvent </td><td> Moves the Openlayers maplayers order to match the layer move spesified in the event, also handles markers layer that it would stay on top</td>
  </tr>
  <tr>
    <td> MapMoveStartEvent </td><td> Stops internal timer scheduled to do a visibility check.</td>
  </tr>
  <tr>
    <td> AfterMapMoveEvent </td><td> Schedules a visibility check to be done with a small delay (delay to improve performance on concurrent moves)</td>
  </tr>
  <tr>
    <td> AfterMapLayerAddEvent </td><td> Checks if added layer has geometries. If not, checks if it has geometryWKT (well-known text) value. If WKT is available, parses it to fill in the geometry array.</td>
  </tr>
</table>

<h2 id="events-the-bundle-sends-out-3">Events the bundle sends out</h2>
<table class="table">
  <tr>
    <th> Event </th><th> When it is triggered/what it tells other components</th>
  </tr>
  <tr>
    <td> MapLayerVisibilityChangedEvent </td><td> Notifies other bundles if a layer has become visible/invisible telling if its out of scale or content area.</td>
  </tr>
</table>

<h2 id="dependencies-8">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [OpenLayers](http://openlayers.org/) </td>
    <td> not linked, assumes its linked by map </td>
    <td> Uses Openlayers to parse WKT geometry, detect if it matches to current maps viewport and to get the centerpoint for layers geometry. Also controls Openlayers to show/hide layers.</td>
  </tr>
</table>


<hr style="height:50px;">


<h1 id="logo-plugin-service">Logo Plugin Service</h1>
<h2 id="description-9">Description</h2>
<p>This service can be used to extend the Logo-plugin. The same LogoPluginService instance is returned on repeated calls to Oskari.clazz.create (singleton pattern).</p>
<pre><code class="language-javascript">var logoService = Oskari.getSandbox().getService(&#39;Oskari.map.LogoPluginService&#39;);
var options = {
  id:&#39;links&#39;,
  callback: function(event) {
    //here you can construct you popup
    alert(&quot;Hello world&quot;);
  }
}
logoService.addLabel(&#39;Title&#39;, options);
</code></pre>
<p>The callback is optional and will receive the click event from the link in the plugin.</p>
<hr style="height:50px;">


<h1 id="markers-plugin">Markers Plugin</h1>
<h2 id="description-10">Description</h2>
<p>The plugin offers Marker functionality for the map. Adding, removing markers and event when a marker has been added or clicked.
Also adds a button to toolbar for adding markers.</p>
<h2 id="todo-2">TODO</h2>
<ul>
<li>marker placeholders are much bigger than actual markers. Clicks are registered on placeholder so the click area is too large.</li>
</ul>
<h2 id="screenshot-5">Screenshot</h2>
<p><img src="/apires/latest/mapping/mapmodule/images/mapmodule-markerplugin.png" alt="screenshot"></p>
<h2 id="plugin-configuration">Plugin configuration</h2>
<p>No configuration is required. Following is optional:</p>
<pre><code class="language-javascript">{
    markerButton : false
}
</code></pre>
<p>A toolbar button is added to toolbar by default (if toolbar bundle is present). Config can be used to prevent this.</p>
<h2 id="plugin-state">Plugin state</h2>
<p>Markers on map are saved in state:</p>
<pre><code class="language-javascript">{
    &quot;markers&quot; : [
        {
            &quot;color&quot;:&quot;ffde00&quot;,
            &quot;shape&quot;:2,
            &quot;msg&quot;:&quot;user input&quot;,
            &quot;y&quot;:7212755,
            &quot;x&quot;:427491,
            &quot;size&quot;:1
        }
    ]
}
</code></pre>
<h2 id="requests-the-plugin-handles-5">Requests the plugin handles</h2>
<table class="table">
  <tr>
    <th>Request</th><th>How does the bundle react</th>
  </tr>
  <tr>
    <td>[MapModulePlugin.AddMarkerRequest](/documentation/requests/addmarkerrequest)</td><td>Adds or modifies marker on the map</td>
  </tr>
  <tr>
    <td>[MapModulePlugin.RemoveMarkersRequest](/documentation/requests/removemarkersrequest)</td><td>Removes one or all markers from map</td>
  </tr>
</table>

<h2 id="requests-the-plugin-sends-out-5">Requests the plugin sends out</h2>
<table class="table">
  <tr>
    <th>Request</th><th>Why/when</th>
  </tr>
  <tr>
    <td> Toolbar.AddToolButtonRequest </td><td> Adds a toolbar button for activating marker tool. </td>
  </tr>
  <tr>
    <td> MapModulePlugin.GetFeatureInfoActivationRequest </td><td> Disable GFI while adding a marker. </td>
  </tr>
  <tr>
    <td> WfsLayerPlugin.ActivateHighlightRequest </td><td> Disable feature highlighting while adding a marker. </td>
  </tr>
  <tr>
    <td> Toolbar.SelectToolButtonRequest </td><td> Reset toolbar to default tool after marker has been added. </td>
  </tr>
</table>

<h2 id="events-the-plugin-listens-to-4">Events the plugin listens to</h2>
<table class="table">
  <tr>
    <th> Event </th><th> How does the bundle react</th>
  </tr>
  <tr>
    <td> MapClickedEvent </td><td> When marker tool is activated, adds the marker to the spot indicated by the event.</td>
  </tr>
  <tr>
    <td> Toolbar.ToolbarLoadedEvent </td><td> Registers the toolbar button if toolbar wasn't available on startup.</td>
  </tr>
  <tr>
    <td> SearchClearedEvent </td><td> Removes all markers.</td>
  </tr>
  <tr>
    <td> AfterRearrangeSelectedMapLayerEvent </td><td> Raises the markers layer to top so markers aren't lost behind another map layer.</td>
  </tr>
</table>

<h2 id="events-the-plugin-sends-out-5">Events the plugin sends out</h2>
<table class="table">
  <tr>
    <th>Event</th><th>Why/when</th>
  </tr>
  <tr>
    <td>AfterAddMarkerEvent</td><td> Notifies that a marker has been added and provides an ID for the marker. </td>
  </tr>
  <tr>
    <td>AfterRemoveMarkersEvent</td><td> Notifies that a marker has been removed. If event has a marker ID a single marker was removed, 
    otherwise all markers were cleared </td>
  </tr>
  <tr>
    <td>MarkerClickEvent</td><td> Notifies that a marker has been clicked. Provides the ID of the clicked marker. </td>
  </tr>
</table>

<h2 id="dependencies-9">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [jQuery](http://api.jquery.com/) </td>
    <td> Version 1.7.1 assumed to be linked </td>
    <td> Used to create the UI</td>
  </tr>
  <tr>
    <td> [Raphael](http://raphaeljs.com/) </td>
    <td> Version 2.1.2 assumed to be linked </td>
    <td> Used to create SVG icons </td>
  </tr>
  <tr>
    <td> [OpenLayers](http://openlayers.org/) </td>
    <td> not linked, assumes its linked by map </td>
    <td> Uses OpenLayers.Layer.Vector for marker layer and OpenLayers.Feature.Vector for markers.</td>
  </tr>
</table>


<hr style="height:50px;">


<h1 id="my-location-plugin">My Location Plugin</h1>
<h2 id="description-11">Description</h2>
<p>The plugin offers the user a center map a his geolocation.</p>
<h2 id="screenshot-6">Screenshot</h2>
<p><img src="/apires/latest/mapping/mapmodule/images/mylocationplugin.png" alt="screenshot"></p>
<h2 id="bundle-configuration-9">Bundle configuration</h2>
<p>No configuration is required. The following configuration options are optional:</p>
<pre><code class="language-javascript">{
  &quot;zoom&quot; : 11,
  &quot;mode&quot;: &quot;single&quot;, 
  &quot;centerMapAutomatically&quot;: true,
  &quot;mobileOnly&quot;: true
}
</code></pre>
<p>Configurable options:</p>
<ul>
<li>zoom: configure zoom level that is used when zoomed to user location (otherwise zoomed based on accuracy)</li>
<li>mode: &quot;single&quot; or &quot;continuous&quot;. <ul>
<li>Single mode: moves map to user location when used. </li>
<li>Continuous mode: Show user location on the map with accuracy circle and follow the user continuously. If user location is outside the map viewport then map is centered on user location.</li>
</ul>
</li>
<li>centerMapAutomatically: <code>true</code> or <code>false</code>. When <code>true</code> map is centered to user location automatically on startup.</li>
<li>mobileOnly: <code>true</code> or <code>false</code>. Restrict functionality to mobile devices. When <code>true</code> the <code>centerMapAutomatically</code> and <code>mode</code> are ignored and the UI is not shown on desktop devices.</li>
</ul>
<p>Default configuration:
{
  &quot;mode: &quot;single&quot;,
  &quot;centerMapAutomatically&quot;: false
}</p>
<h2 id="requests-the-plugin-handles-6">Requests the plugin handles</h2>
<table class="table">
  <tr>
    <th>Request</th><th>How does the bundle react</th>
  </tr>
  <tr>
    <td> [MyLocationPlugin.GetUserLocationRequest](/documentation/requests/getuserlocationrequest) </td><td> Gets user geolocation</td>
  </tr>
</table>

<h2 id="requests-the-plugin-sends-out-6">Requests the plugin sends out</h2>
<table class="table">
  <tr>
    <th>Request</th><th>Where/why it's used</th>
  </tr>
  <tr>
    <td>StartUserLocationTrackingRequest</td><td>Start user tracking</td>
  </tr>
  <tr>
    <td>StopUserLocationTrackingRequest</td><td>Stop user tracking</td>
  </tr>
</table>

<h2 id="events-the-plugin-listens-to-5">Events the plugin listens to</h2>
<p>This bundle doesn&#39;t listen to any events.</p>
<h2 id="events-the-plugin-sends-out-6">Events the plugin sends out</h2>
<table class="table">
  <tr>
    <th>Event</th><th>Why/when</th>
  </tr>
  <tr>
    <td>[UserLocationEvent](/documentation/events/userlocationevent)</td>
    <td>Sends the event when getted user geolocation.</td>
  </tr>
</table>


<h2 id="dependencies-10">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [jQuery](http://api.jquery.com/) </td>
    <td> Version 1.7.1 assumed to be linked </td>
    <td> Used to create the UI</td>
  </tr>
</table>


<hr style="height:50px;">


<h1 id="pan-buttons-plugin">Pan Buttons Plugin</h1>
<h2 id="description-12">Description</h2>
<p>The plugin offers the user a move my by pan buttons</p>
<h2 id="todo-3">TODO</h2>
<ul>
<li>image url config (can be used by mapmodule image path [getImageUrl()])</li>
</ul>
<h2 id="screenshot-7">Screenshot</h2>
<p><img src="/apires/latest/mapping/mapmodule/images/panbuttons.png" alt="screenshot"></p>
<h2 id="bundle-configuration-10">Bundle configuration</h2>
<p>No configuration is required. Following is optional:</p>
<p>The styling and font of the plugin are configurable, with variables <code>toolStyle</code> (String) and <code>font</code> (String), respectively. A CSS class of <code>oskari-publisher-font-&lt;font&gt;</code> is expected to be defined with font-family definition. Following values are supported for the <code>toolStyle</code>: <code>rounded-light</code>, <code>rounded-dark</code>, <code>sharp-dark</code>, <code>sharp-light</code>, <code>3d-dark</code> and <code>3d-light</code>. An image <code>panbutton-sprites-&lt;toolStyle&gt;.png</code> is expected to be found in plugin&#39;s image resources directory.</p>
<h2 id="requests-the-plugin-handles-7">Requests the plugin handles</h2>
<p>This plugin doesn&#39;t handle any requests.</p>
<h2 id="requests-the-plugin-sends-out-7">Requests the plugin sends out</h2>
<p>This plugin doesn&#39;t sends any requests.</p>
<h2 id="events-the-plugin-listens-to-6">Events the plugin listens to</h2>
<p>This bundle doesn&#39;t listen to any events.</p>
<h2 id="events-the-plugin-sends-out-7">Events the plugin sends out</h2>
<p>This bundle doesn&#39;t send any events.</p>
<h2 id="dependencies-11">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [jQuery](http://api.jquery.com/) </td>
    <td> Version 1.7.1 assumed to be linked </td>
    <td> Used to create the UI</td>
  </tr>
</table>


<hr style="height:50px;">


<h1 id="portti2-zoombar-plugin">Portti2 Zoombar Plugin</h1>
<h2 id="description-13">Description</h2>
<p>The plugin offers the user a zoom control for the map. Gets the initial zoom level from the map it is registered to when started.</p>
<h2 id="todo-4">TODO</h2>
<ul>
<li>Tooltips</li>
</ul>
<h2 id="screenshot-8">Screenshot</h2>
<p><img src="/apires/latest/mapping/mapmodule/images/zoombar.png" alt="screenshot"></p>
<h2 id="bundle-configuration-11">Bundle configuration</h2>
<p>No configuration is required, but optionally location can be overridden by giving:</p>
<pre><code class="language-javascript">{
  location : {
    top : &#39;10px&#39;,
    left : &#39;10px&#39;
  }
}
</code></pre>
<p>Bottom and right can also be used.</p>
<p>The styling and font of the plugin are configurable, with variables <code>toolStyle</code> (Object) and <code>font</code> (String), respectively. A CSS class of <code>oskari-publisher-font-&lt;font&gt;</code> is expected to be defined with font-family definition. Following styles are supported for the <code>toolStyle.val</code>: <code>rounded-light</code>, <code>rounded-dark</code>, <code>sharp-dark</code>, <code>sharp-light</code>, <code>3d-dark</code> and <code>3d-light</code>. Images <code>zoombar-&lt;toolStyle&gt;.png</code>, <code>zoombar-cursor-&lt;toolStyle&gt;.png</code>, <code>zoombar_minus-&lt;toolStyle&gt;.png</code> and <code>zoombar_minus-&lt;toolStyle&gt;.png</code> are expected to be found in plugin&#39;s image resources directory. Also, widths and heights should be configured following the example:</p>
<pre><code class="language-javascript">{
  val: &#39;rounded-dark&#39;,  // The id of the style.
  widthPlus: &#39;22px&#39;,    // Width of the &#39;plus&#39; image.
  widthMinus: &#39;22px&#39;,   // Width of the &#39;minus&#39; image.
  widthCenter: &#39;22px&#39;,  // Width of the &#39;center&#39; image.
  heightPlus: &#39;38px&#39;,   // Height of the &#39;plus&#39; image.
  heightMinus: &#39;39px&#39;,  // Height of the &#39;minus&#39; image.
  heightCenter: 12,     // Height of the &#39;center&#39; image. NOTE! an integer.
  heightCursor: &#39;18px&#39;, // Height of the &#39;cursor&#39; image.
  widthCursor: &#39;17px&#39;   // Width of the &#39;cursor&#39; image.
}
</code></pre>
<h2 id="requests-the-plugin-handles-8">Requests the plugin handles</h2>
<p>This plugin doesn&#39;t handle any requests.</p>
<h2 id="requests-the-plugin-sends-out-8">Requests the plugin sends out</h2>
<p>This plugin doesn&#39;t sends any requests.</p>
<h2 id="events-the-plugin-listens-to-7">Events the plugin listens to</h2>
<p>|| Event || How does the bundle react ||
|| AfterMapMoveEvent || Zoom to in or out \ ||</p>
<h2 id="events-the-plugin-sends-out-8">Events the plugin sends out</h2>
<p>This bundle doesn&#39;t send any events.</p>
<h2 id="dependencies-12">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [jQuery](http://api.jquery.com/) </td>
    <td> Version 1.7.1 assumed to be linked </td>
    <td> Used to create the UI</td></tr>
  <tr>
    <td> [RightJS slider](http://rightjs.org/ui/slider) </td>
    <td> https://github.com/nls-oskari/oskari/blob/master/libraries/rightjs/javascripts/right/slider.js </td>
    <td> RightJS UI component for slider - used to show zoombar </td>
  </tr>
</table>


<hr style="height:50px;">


<h1 id="publishedtoolbar-plugin">PublishedToolbar Plugin</h1>
<h2 id="description-14">Description</h2>
<p>This is a plugin to bring toolbar functionality to published maps. It provides a container for the toolbar bundle to add itself into and available buttons allowing publishable maps to be configured to include only the wanted tools. The toolbar bundle handles most requests, except &quot;Toolbar.ToolContainerRequest&quot;, which are handled by publishertoolbar.</p>
<h2 id="bundle-configuration-12">Bundle configuration</h2>
<pre><code class="language-javascript">{
    &quot;toolbarId&quot; : &quot;PublisherToolbar&quot;
}
</code></pre>
<p>No configuration is required. If the toolbarId is defined, then publishertoolbar creates a new toolbar using the given id into itself. This is particularily useful when configuring a published map.</p>
<h2 id="bundle-state-4">Bundle state</h2>
<p>No statehandling has been implemented for this.</p>
<h2 id="requests-the-bundle-handles-4">Requests the bundle handles</h2>
<table class="table">
<tr>
  <th> Request </th><th> How does the bundle react</th>
</tr>
<tr>
  <td> MapModulePlugin.MapLayerVisibilityRequest </td><td> Hides a maplayer or changes a hidden layer to visible.</td>
</tr>
<tr>
  <td> MapModulePlugin.MapMoveByLayerContentRequest </td><td> Moves the map to a location and/or scale where the maplayer has content. (Maplayer geometry is visible in viewport/scale is in range for layer).</td>
</tr>
</table>

<h2 id="requests-the-bundle-handles-5">Requests the bundle handles</h2>
<table class="table">
  <tr>
    <th>Request</th><th>How does the bundle react</th>
  </tr>
  <tr>
    <td> Toolbar.ToolContainerRequest </td><td> Creates and removes popup content containers within the plugin container provided by publishertoolbar</td>
  </tr>
</table>

<h2 id="requests-the-bundle-sends-out-4">Requests the bundle sends out</h2>
<table class="table">
  <tr>
    <th>Request</th><th>Why/when</th>
  </tr>
  <tr>
    <td> Toolbar.ToolbarRequest </td><td> Adds a toolbar into the published map. </td>
  </tr>
</table>

<h2 id="events-the-bundle-listens-to-5">Events the bundle listens to</h2>
<p>This bundle doesn&#39;t listen to any events.</p>
<h2 id="events-the-bundle-sends-out-4">Events the bundle sends out</h2>
<p>This bundle doesn&#39;t send any events.</p>
<h2 id="dependencies-13">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [OpenLayers](http://openlayers.org/) </td>
    <td> not linked, assumes its linked by map </td>
    <td> Uses Openlayers to parse WKT geometry, detect if it matches to current maps viewport and to get the centerpoint for layers geometry. Also controls Openlayers to show/hide layers.</td>
  </tr>
  <tr>
    <td> [Oskari toolbar](/documentation/bundles/framework/toolbar) </td>
    <td> Oskari's ToolbarBundle </td>
    <td> That handles the toolbar functionality</td>
  </tr>
</table>


<hr style="height:50px;">


<h1 id="scale-bar-plugin">Scale Bar Plugin</h1>
<h2 id="description-15">Description</h2>
<p>The plugin adds a scale bar to the map it is registered to.</p>
<h2 id="screenshot-9">Screenshot</h2>
<p><img src="/apires/latest/mapping/mapmodule/images/scalebar.png" alt="screenshot"></p>
<h2 id="bundle-configuration-13">Bundle configuration</h2>
<p>No configuration is required.</p>
<h2 id="requests-the-plugin-handles-9">Requests the plugin handles</h2>
<p>This plugin doesn&#39;t handle any requests.</p>
<h2 id="requests-the-plugin-sends-out-9">Requests the plugin sends out</h2>
<p>This plugin doesn&#39;t sends any requests.</p>
<h2 id="events-the-plugin-listens-to-8">Events the plugin listens to</h2>
<table class="table">
  <tr>
    <th>Event</th><th>How does the bundle react</th>
  </tr>
  <tr>
    <td>AfterMapMoveEvent</td><td>Updates ui to current zoom level</td>
  </tr>
</table>

<h2 id="events-the-plugin-sends-out-9">Events the plugin sends out</h2>
<p>This bundle doesn&#39;t send any events.</p>
<h2 id="dependencies-14">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td>[OpenLayers](http://openlayers.org/)</td>
    <td>not linked, assumes its linked by map</td>
    <td>Uses OpenLayers.Control.ScaleLine to render the scalebar.</td>
  </tr>
</table>


<hr style="height:50px;">


<h1 id="search-plugin">Search Plugin</h1>
<h2 id="description-16">Description</h2>
<p>Creates a search field for places in published maps.</p>
<h2 id="bundle-configuration-14">Bundle configuration</h2>
<p>No configuration is required. Following is optional:</p>
<p>The styling and font of the plugin are configurable, with variables <code>toolStyle</code> (Object) and <code>font</code> (String), respectively. A CSS class of <code>oskari-publisher-font-&lt;font&gt;</code> is expected to be defined with font-family definition. Following styles are supported for the <code>toolStyle.val</code>: <code>rounded-light</code>, <code>rounded-dark</code>, <code>sharp-dark</code>, <code>sharp-light</code>, <code>3d-dark</code> and <code>3d-light</code>. Images for search field background are expected to be found in plugin&#39;s image resources directory for left, middle and right sides of the field: <code>search-tool-&lt;toolStyle&gt;_01.png</code>, <code>search-tool-&lt;toolStyle&gt;_02.png</code> and <code>search-tool-&lt;toolStyle&gt;_03.png</code>, respectively. Also, the widths of the images are expected to be defined in config object:</p>
<pre><code class="language-javascript">{
  val: &#39;rounded-dark&#39;, // The id of the style.
  widthLeft: &#39;17px&#39;,   // Width of the left side image.
  widthRight: &#39;32px&#39;   // Width of the right side image.
}
</code></pre>
<h2 id="bundle-state-5">Bundle state</h2>
<p>No statehandling has been implemented.</p>
<h2 id="requests-the-bundle-handles-6">Requests the bundle handles</h2>
<p>This bundle doesn&#39;t handle any requests.</p>
<h2 id="requests-the-bundle-sends-out-5">Requests the bundle sends out</h2>
<table class="table">
  <tr>
    <th>Request</th><th>Why/when</th>
  </tr>
  <tr>
    <td>DisableMapKeyboardMovementRequest</td>
    <td>Disables the map movement when entering text to the search field.</td>
  </tr>
  <tr>
    <td>EnableMapKeyboardMovementRequest</td>
    <td>Enables the map movement when the search field blurs again.</td>
  </tr>
  <tr>
    <td>MapMoveRequest</td>
    <td>Moves the map to a location in the results table received from the search service.</td>
  </tr>
</table>

<h2 id="events-the-bundle-listens-to-6">Events the bundle listens to</h2>
<p>This bundle doesn&#39;t listen to any events.</p>
<h2 id="events-the-bundle-sends-out-5">Events the bundle sends out</h2>
<p>This bundle doesn&#39;t send out any events.</p>
<h2 id="dependencies-15">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [jQuery](http://api.jquery.com/) </td>
    <td> Version 1.7.1 assumed to be linked (on page locally in portal) </td>
    <td> Used to create the UI and to sort the layers</td>
  </tr>
  <tr>
    <td>[OpenLayers](http://openlayers.org/)</td>
    <td>not linked, assumes its linked by map</td>
    <td>Uses OpenLayers' popup</td>
  </tr>
  <tr>
    <td>Oskari.mapframework.bundle.search.service.SearchService</td>
    <td>Expects to be present in application setup</td>
    <td>Sends the search request trough the service</td>
  </tr>
</table>



<hr style="height:50px;">


<h1 id="vector-layer-plugin">Vector Layer Plugin</h1>
<h2 id="description-17">Description</h2>
<p> Provides functionality to draw vector layers on the map.</p>
<h2 id="bundle-configuration-15">Bundle configuration</h2>
<p>No configuration is required. Following is optional:</p>
<pre><code class="language-javascript">{
    &quot;layers&quot;: [    
        {
            &quot;id&quot;: &quot;EXAMPLE1&quot;,
            &quot;style&quot;: {
                &quot;fill&quot;: {
                    &quot;color&quot;: &quot;#ff00ff&quot;
                },
                &quot;stroke&quot;: {
                    &quot;color&quot;: &quot;#ff00ff&quot;,
                    &quot;width&quot;: 3
                },
                &quot;text&quot;: {
                    &quot;fill&quot;: {
                        &quot;color&quot;: &quot;#0000ff&quot;
                    },
                    &quot;stroke&quot;: {
                        &quot;color&quot;: &quot;#ff00ff&quot;,
                        &quot;width&quot;: 4
                    }
                }
            }
        }
    ]
}
</code></pre>
<p>This configuration creates one (or many) layer(s) when plugin is started. You can tell layer default style for style object. When feature added layer style is used if feature request not contains feature style. If layer and feature style is not defined using defaults.</p>
<h2 id="bundle-state-6">Bundle state</h2>
<p>No statehandling has been implemented.</p>
<h2 id="requests-the-bundle-handles-7">Requests the bundle handles</h2>
<table class="table">
  <tr>
    <th>Request</th><th>How does the bundle react</th>
  </tr>
  <tr>
    <td>MapModulePlugin.AddFeaturesToMapRequest</td><td>Add features on the map</td>
  </tr>
  <tr>
    <td>MapModulePlugin.RemoveFeaturesFromMapRequest</td><td>Removes features from map</td>
  </tr>
</table>

<h2 id="requests-the-bundle-sends-out-6">Requests the bundle sends out</h2>
<p>This plugin doesn&#39;t sends any requests.</p>
<h2 id="events-the-bundle-listens-to-7">Events the bundle listens to</h2>
<table class="table">
  <tr>
    <th> Event </th><th> How does the bundle react</th>
  </tr>
  <tr>
    <td> AfterMapLayerRemoveEvent </td><td> Remove OpenLayer's layer from map. </td>
  </tr>
  <tr>
    <td> AfterChangeMapLayerOpacityEvent </td><td> Update OpenLayer's layer opacity. </td>
  </tr>
  
</table>

<h2 id="events-the-bundle-sends-out-6">Events the bundle sends out</h2>
<p>This bundle doesn&#39;t send out any events.</p>
<h2 id="dependencies-16">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [jQuery](http://api.jquery.com/) </td>
    <td> Version 1.7.1 assumed to be linked (on page locally in portal) </td>
    <td> Used to create the UI and to sort the layers</td>
  </tr>
  <tr>
    <td>[OpenLayers](http://openlayers.org/)</td>
    <td>not linked, assumes its linked by map</td>
    <td>Used to create the vector layer.</td>
  </tr>
</table>



<hr style="height:50px;">


<h1 id="vector-tile-layer-plugin">Vector Tile Layer Plugin</h1>
<h2 id="description-18">Description</h2>
<p>The plugin offers functionality to add Vector tile layers (<a href="https://www.mapbox.com/vector-tiles/specification/">MVT</a>) to the map. Added layers support styling with Oskari style definitions, see featureStyle/optionalStyles in AddFeaturesToMapRequest. Maps with projection EPSG:3857 (Web Mercator) work out of the box, other projections need tile grid configuration in the layer options.</p>
<h2 id="layer-data-model">Layer data model</h2>
<p>The layer domain object is subclassed from AbstractLayer as usual.</p>
<p>The layer url must be in XYZ-format, eg. <code>https://mytiles.com/vectortile/{epsg}/{z}/{x}/{y}.pbf</code>. Placeholder <code>epsg</code> is optional and if present, will be replaced with current projection of the map, eg. <code>EPSG:3067</code>. Placeholders <code>x</code>, <code>y</code> and <code>z</code> will be replaced with tile coordinates calculated from the map view and tile grid.</p>
<p>The layer model field <code>options</code> is of type object having multiple optional keys <code>tileGrid</code>, <code>styles</code>, <code>hover</code> and <code>attributions</code>.</p>
<h3 id="tile-grid">Tile Grid</h3>
<p>Map projections apart from EPSG:3857 (Web Mercator) need tile grid configuration in the layer options. The configuration format is in the format of Open Layers <a href="http://openlayers.org/en/v5.2.0/apidoc/module-ol_tilegrid_TileGrid-TileGrid.html#TileGrid">TileGrid class options</a>. For example:</p>
<pre><code class="language-javascript">&quot;tileGrid&quot;: {
    &quot;origin&quot;: [-548576, 8388608],
    &quot;resolutions&quot;: [8192, 4096, 2048, 1024, 512, 256, 128, 64, 32, 16, 8, 4, 2, 1, 0.5, 0.25],
    &quot;tileSize&quot;: [256, 256]
}
</code></pre>
<h3 id="styles">Styles</h3>
<p>The appearance of the vector layer is defined with Oskari JSON style definition for each MVT internal &quot;layer&quot;. If the <code>styles</code> key exists in the layer options, the value should be a object with at least key <code>default</code>, having the defalult style definition. Additionally other styles can be defined with additional keys, eg.</p>
<pre><code class="language-javascript">&quot;styles&quot;: {
    &quot;default&quot;: {...},
    &quot;myOwnStyle&quot;: {...},
    ...
}
</code></pre>
<p>Each style definition has keys for the MVT layer names that should be rendered:</p>
<pre><code class="language-javascript">&quot;styles&quot;: {
    &quot;default&quot;: {
        &quot;building&quot;: {...}
        &quot;water&quot;: {...},
        &quot;transportation&quot;: {...},
        &quot;landcover&quot;: {...}
    },
    ...
}
</code></pre>
<p>And each key has object value with one or both keys <code>featureStyle</code>, <code>optionalStyles</code>.</p>
<p>See <a href="/documentation/examples/oskari-style">Oskari JSON style</a> for featureStyle/optionalStyle object definition.</p>
<p>Style example:</p>
<pre><code class="language-javascript">&quot;styles&quot;: {
    &quot;default&quot;: {
        &quot;building&quot;: {
            &quot;featureStyle&quot;: {
                &quot;fill&quot;: {
                    &quot;color&quot;: &quot;#ff00ff&quot;
                }
            },
            &quot;optionalStyles&quot;: [
                {
                    &quot;property&quot;: {
                        &quot;key&quot;: &quot;id&quot;,
                        &quot;value&quot;: 417771333
                    },
                    &quot;stroke&quot;: {
                        &quot;color&quot;: &quot;#000000&quot;,
                        &quot;width&quot;: 2
                    }
                }
            ]
        }
    },
    &quot;black_buildings&quot;: {
        &quot;building&quot;: {
            &quot;featureStyle&quot;: {
                &quot;fill&quot;: {
                    &quot;color&quot;: &quot;#000000&quot;
                }
            }
        }
    }
}
</code></pre>
<h3 id="hover">Hover</h3>
<p>Hover describes how to visualize features on mouse hover and what kind of tooltip should be shown.
Hover has two optional keys <code>featureStyle</code> and <code>content</code>.</p>
<p>Content should be content of tooltip as an array. Each object creates a row to the tooltip.
Each row object has <code>key</code> or <code>keyProperty</code> and <code>valueProperty</code>.
<code>key</code> is a label and will be rendered as is.
<code>valueProperty</code> and <code>keyProperty</code> will be fetched from the feature&#39;s properties.</p>
<pre><code class="language-javascript">&quot;hover&quot;: {
    &quot;featureStyle&quot;:  {...},
    &quot;content&quot;: [
        { &quot;key&quot;: &quot;Feature Data&quot; },
        { &quot;key&quot;: &#39;Feature ID&#39;, &quot;valueProperty&quot;: &quot;id&quot; },
        { &quot;keyProperty&quot;: &quot;type&quot;, &quot;valueProperty&quot;: &quot;name&quot; }
    ]
}
</code></pre>
<p>Exampe above would create a tooltip like</p>
<p>Feature Data
Feature ID: 23098523243
Road: Main Street</p>
<h3 id="attributions">Attributions</h3>
<p>Defines layer attributions to be shown at the bottom of the map.
If the <code>link</code> property is defined, renders an attribution as a link to the given address.</p>
<pre><code class="language-javascript">&quot;attributions&quot;: [
    {&quot;label&quot;: &quot; MapTiler&quot;, &quot;link&quot;:&quot;https://www.maptiler.com/license/maps/&quot;},
    {&quot;label&quot;: &quot; OpenStreetMap contributors&quot;, &quot;link&quot;:&quot;https://www.openstreetmap.org/copyright&quot;}
]
</code></pre>
<h2 id="todo-5">TODO</h2>
<ul>
<li>Layer collections. Only individual layers are currently supported.</li>
</ul>
<h2 id="plugin-configuration-1">Plugin configuration</h2>
<p>No configuration is required. </p>
<h2 id="plugin-state-1">Plugin state</h2>
<p>No statehandling has been implemented.</p>
<h2 id="dependencies-17">Dependencies</h2>
<table class="table">
  <tr>
    <th>Dependency</th><th>Linked from</th><th>Purpose</th>
  </tr>
  <tr>
    <td> [OpenLayers](http://openlayers.org/) </td>
    <td> imported from NPM</td>
    <td> Uses OpenLayers Vector tile source & layer support</td>
  </tr>
</table>
